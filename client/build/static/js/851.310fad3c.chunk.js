"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[851],{9851:(e,l,t)=>{t.r(l),t.d(l,{default:()=>B,fetchNews:()=>$,getTotalPages:()=>W});var n=t(5043);const s=t(6213).A.create({baseURL:"http://parseserver.us:4001",timeout:6e4,headers:{"Content-Type":"application/json"}});var i=t(4194),a=t(9135),o=t(4535),r=t(7353),d=t(1596),c=t(7067),u=t(5795),h=t(1906),x=t(9190),p=t(8988),v=t(6980),g=t(3561),y=t(579);const j=e=>{let{value:l,handleChange:t,options:n,name:s,label:i}=e;return(0,y.jsx)(r.A,{sx:{minWidth:120},children:(0,y.jsxs)(v.A,{fullWidth:!0,children:[(0,y.jsx)(x.A,{id:`label_${s}`,children:i}),(0,y.jsxs)(g.A,{labelId:`label_${s}`,name:s,value:l,label:i,onChange:t,children:[(0,y.jsx)(p.A,{value:"",children:"Select"}),null===n||void 0===n?void 0:n.map((e=>(0,y.jsx)(p.A,{value:e.key,children:e.label},e.key)))]})]})})},m=(0,o.Ay)(d.A)((e=>{let{theme:l}=e;return{backgroundColor:"#fff",...l.typography.body2,padding:l.spacing(1),textAlign:"center",color:l.palette.text.secondary,...l.applyStyles("dark",{backgroundColor:"#1A2027"})}})),f=e=>{let{setQ:l}=e;const[t,s]=n.useState({state:"",topic:"",keyword:""}),i=e=>{s((l=>({...l,[e.target.name]:e.target.value})))},a=e=>{e.preventDefault(),l(t.keyword)};return(0,y.jsx)(r.A,{sx:{flexGrow:1},children:(0,y.jsx)("form",{onSubmit:a,children:(0,y.jsxs)(c.A,{container:!0,spacing:2,children:[(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(j,{name:"state",label:"State",options:[{key:"california",label:"California"},{key:"indiana",label:"Indiana"}],value:t.state,handleChange:i})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(j,{name:"topic",label:"Topic",options:[{key:"business",label:"Business"},{key:"entertainment",label:"Entertainment"},{key:"general",label:"General"},{key:"health",label:"Health"},{key:"sports",label:"Sports"},{key:"technology",label:"Technology"}],value:t.topic,handleChange:i})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(u.A,{name:"keyword",label:"Keyword",variant:"outlined",type:"search",placeholder:"keyword to search",value:t.keyword,onChange:i,fullWidth:!0})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(h.A,{variant:"contained",fullWidth:!0,type:"submit",onClick:a,sx:{height:55},children:"Search"})})})]})})})};var b=t(7122),w=t(1637);function k(){return(0,y.jsx)(r.A,{sx:{display:"flex",marginTop:5,marginBottom:5,justifyContent:"center"},children:(0,y.jsx)(w.A,{})})}var A=t(3774),C=t(7020);(0,A.eU)({});const S=(0,C.tG)("newsObjectLS",{});var T=t(6178),z=t.n(T);const I=e=>{var l;let{record:t}=e;return(0,y.jsx)("li",{style:{marginBottom:"30px"},children:(0,y.jsxs)("div",{style:{display:"flex",gap:"16px"},children:[(0,y.jsx)("div",{style:{maxWidth:"150px",position:"relative"},children:(0,y.jsx)("img",{src:null!==(l=t.urlToImage)&&void 0!==l?l:"https://www.pngitem.com/pimgs/m/439-4390399_placeholder-image-newsletter-clipart-hd-png-download.png",alt:"",style:{width:"100%"}})}),(0,y.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,y.jsx)("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"10px"},children:t.title}),(0,y.jsx)("div",{style:{fontSize:"12px",marginBottom:"10px"},children:t.description}),(0,y.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline",fontSize:"11px"},children:z()(t.publishedAt).fromNow()})]})]})})},W=(e,l)=>Math.floor(e/l),$=async e=>{let{q:l,page:t}=e;const n=`/news?province=&topic=&search=${encodeURIComponent(l)}&page=${t}`;return(await s.get(n)).data},B=()=>{var e,l,t,s,o,r,d,c;const[u,h]=(0,b.fp)(S),[x,p]=n.useState(),[v,g]=n.useState(""),[j,m]=n.useState(0),[w,A]=n.useState(!1),[C,T]=n.useState(null),z=n.useMemo((()=>{var e,l;return null!==x&&void 0!==x&&null!==(e=x.results)&&void 0!==e&&e.totalPages?null===x||void 0===x||null===(l=x.results)||void 0===l?void 0:l.totalPages:0}),[null===x||void 0===x||null===(e=x.results)||void 0===e?void 0:e.totalPages]),W=n.useMemo((()=>`${encodeURIComponent(v)}_${j}_100`),[j,v]),B=(0,n.useCallback)(((e,l)=>{h((t=>({...t,[e]:l})))}),[h]),R=n.useCallback((async e=>{try{if(A(!0),T(null),u[W]&&!e){var l;const e=(new Date).getTime(),t=null===(l=u[W])||void 0===l?void 0:l.expiryRef;if(t){const l=e-t;if(Math.round(l/1e3)<=7200)return console.log("data from cache: ",W,", ",u[W]),void p(u[W])}}console.log("fresh data: ",W);const t=await $({page:j,q:v});B(W,{...t,expiryRef:(new Date).getTime(),stateKey:W}),p(t)}catch(t){t instanceof Error?T(t.message):"string"===typeof t&&T(t)}finally{A(!1)}}),[j,v,W,B,u]);return n.useEffect((()=>{R()}),[R]),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{id:"filter-box",children:(0,y.jsx)(f,{setQ:g})}),(0,y.jsxs)("div",{id:"content",children:[C&&(0,y.jsx)("div",{children:(0,y.jsx)(i.A,{severity:"error",children:C})}),w&&(0,y.jsx)(k,{}),(null===x||void 0===x||null===(l=x.results)||void 0===l?void 0:l.rows)&&(null===x||void 0===x||null===(t=x.results)||void 0===t||null===(s=t.rows)||void 0===s?void 0:s.length)>0&&(0,y.jsxs)(y.Fragment,{children:[" ",(0,y.jsx)("ul",{children:null===x||void 0===x||null===(o=x.results)||void 0===o||null===(r=o.rows)||void 0===r?void 0:r.map((e=>(0,y.jsx)(I,{record:e},e.objectId)))}),(0,y.jsx)("div",{children:(0,y.jsx)(a.A,{count:z,page:j+1,onChange:(e,l)=>{m(l-1),window.scrollTo(0,0)}})})]}),(!(null!==x&&void 0!==x&&null!==(d=x.results)&&void 0!==d&&d.rows)||0===(null===x||void 0===x||null===(c=x.results)||void 0===c?void 0:c.rows.length))&&!w&&!C&&(0,y.jsx)("div",{style:{marginTop:20},children:(0,y.jsx)(i.A,{severity:"warning",children:"No News Found."})})]})]})}}}]);
//# sourceMappingURL=851.310fad3c.chunk.js.map