"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[851],{9851:(e,l,n)=>{n.r(l),n.d(l,{default:()=>R,fetchNews:()=>B,getTotalPages:()=>$});var t=n(5043);const s=n(6213).A.create({baseURL:"http://parseserver.us:4001",timeout:6e4,headers:{"Content-Type":"application/json"}});var i=n(4194),a=n(9135),o=n(4535),r=n(7353),d=n(1596),c=n(7067),u=n(5795),h=n(1906),x=n(9190),p=n(8988),v=n(6980),g=n(3561),y=n(579);const j=e=>{let{value:l,handleChange:n,options:t,name:s,label:i}=e;return(0,y.jsx)(r.A,{sx:{minWidth:120},children:(0,y.jsxs)(v.A,{fullWidth:!0,children:[(0,y.jsx)(x.A,{id:`label_${s}`,children:i}),(0,y.jsxs)(g.A,{labelId:`label_${s}`,name:s,value:l,label:i,onChange:n,children:[(0,y.jsx)(p.A,{value:"",children:"Select"}),null===t||void 0===t?void 0:t.map((e=>(0,y.jsx)(p.A,{value:e.key,children:e.label},e.key)))]})]})})},m=(0,o.Ay)(d.A)((e=>{let{theme:l}=e;return{backgroundColor:"#fff",...l.typography.body2,padding:l.spacing(1),textAlign:"center",color:l.palette.text.secondary,...l.applyStyles("dark",{backgroundColor:"#1A2027"})}})),f=e=>{let{setQ:l}=e;const[n,s]=t.useState({state:"",topic:"",keyword:""}),i=e=>{s((l=>({...l,[e.target.name]:e.target.value})))};return(0,y.jsx)(r.A,{sx:{flexGrow:1},children:(0,y.jsxs)(c.A,{container:!0,spacing:2,children:[(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(j,{name:"state",label:"State",options:[{key:"california",label:"California"},{key:"indiana",label:"Indiana"}],value:n.state,handleChange:i})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(j,{name:"topic",label:"Topic",options:[{key:"business",label:"Business"},{key:"entertainment",label:"Entertainment"},{key:"general",label:"General"},{key:"health",label:"Health"},{key:"sports",label:"Sports"},{key:"technology",label:"Technology"}],value:n.topic,handleChange:i})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(u.A,{name:"keyword",label:"Keyword",variant:"outlined",placeholder:"keyword to search",value:n.keyword,onChange:i})})}),(0,y.jsx)(c.A,{size:{xs:6,md:3},children:(0,y.jsx)(m,{children:(0,y.jsx)(h.A,{variant:"contained",fullWidth:!0,onClick:()=>{console.log("inputState: ",n),l(n.keyword)},sx:{height:55},children:"Search"})})})]})})};var b=n(7122),w=n(1637);function k(){return(0,y.jsx)(r.A,{sx:{display:"flex",marginTop:5,marginBottom:5,justifyContent:"center"},children:(0,y.jsx)(w.A,{})})}var A=n(3774),C=n(7020);(0,A.eU)({});const S=(0,C.tG)("newsObjectLS",{});var T=n(6178),z=n.n(T);const I=e=>{var l;let{record:n}=e;return(0,y.jsx)("li",{style:{marginBottom:"30px"},children:(0,y.jsxs)("div",{style:{display:"flex",gap:"16px"},children:[(0,y.jsx)("div",{style:{maxWidth:"150px",position:"relative"},children:(0,y.jsx)("img",{src:null!==(l=n.urlToImage)&&void 0!==l?l:"https://www.pngitem.com/pimgs/m/439-4390399_placeholder-image-newsletter-clipart-hd-png-download.png",alt:"",style:{width:"100%"}})}),(0,y.jsxs)("div",{style:{flex:1,display:"flex",flexDirection:"column"},children:[(0,y.jsx)("div",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"10px"},children:n.title}),(0,y.jsx)("div",{style:{fontSize:"12px",marginBottom:"10px"},children:n.description}),(0,y.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"baseline",fontSize:"11px"},children:z()(n.publishedAt).fromNow()})]})]})})},$=(e,l)=>Math.floor(e/l),B=async e=>{let{q:l,page:n}=e;const t=`/news?province=&topic=&search=${encodeURIComponent(l)}&page=${n}`;return(await s.get(t)).data},R=()=>{var e,l,n,s,o,r,d,c;const[u,h]=(0,b.fp)(S),[x,p]=t.useState(),[v,g]=t.useState(""),[j,m]=t.useState(0),[w,A]=t.useState(!1),[C,T]=t.useState(null),z=t.useMemo((()=>{var e,l;return null!==x&&void 0!==x&&null!==(e=x.results)&&void 0!==e&&e.totalPages?null===x||void 0===x||null===(l=x.results)||void 0===l?void 0:l.totalPages:0}),[null===x||void 0===x||null===(e=x.results)||void 0===e?void 0:e.totalPages]),$=t.useMemo((()=>`${encodeURIComponent(v)}_${j}_100`),[j,v]),R=(0,t.useCallback)(((e,l)=>{h((n=>({...n,[e]:l})))}),[h]),W=t.useCallback((async e=>{try{if(A(!0),T(null),u[$]&&!e){var l;const e=(new Date).getTime(),n=null===(l=u[$])||void 0===l?void 0:l.expiryRef;if(n){const l=e-n;if(Math.round(l/1e3)<=7200)return console.log("data from cache: ",$,", ",u[$]),void p(u[$])}}console.log("fresh data: ",$);const n=await B({page:j,q:v});R($,{...n,expiryRef:(new Date).getTime(),stateKey:$}),p(n)}catch(n){n instanceof Error?T(n.message):"string"===typeof n&&T(n)}finally{A(!1)}}),[j,v,$,R,u]);return t.useEffect((()=>{W()}),[W]),(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{id:"filter-box",children:(0,y.jsx)(f,{setQ:g})}),(0,y.jsxs)("div",{id:"content",children:[C&&(0,y.jsx)("div",{children:(0,y.jsx)(i.A,{severity:"error",children:C})}),w&&(0,y.jsx)(k,{}),(null===x||void 0===x||null===(l=x.results)||void 0===l?void 0:l.rows)&&(null===x||void 0===x||null===(n=x.results)||void 0===n||null===(s=n.rows)||void 0===s?void 0:s.length)>0&&(0,y.jsxs)(y.Fragment,{children:[" ",(0,y.jsx)("ul",{children:null===x||void 0===x||null===(o=x.results)||void 0===o||null===(r=o.rows)||void 0===r?void 0:r.map((e=>(0,y.jsx)(I,{record:e},e.objectId)))}),(0,y.jsx)("div",{children:(0,y.jsx)(a.A,{count:z,page:j+1,onChange:(e,l)=>{m(l-1),window.scrollTo(0,0)}})})]}),(!(null!==x&&void 0!==x&&null!==(d=x.results)&&void 0!==d&&d.rows)||0===(null===x||void 0===x||null===(c=x.results)||void 0===c?void 0:c.rows.length))&&!w&&!C&&(0,y.jsx)("div",{style:{marginTop:20},children:(0,y.jsx)(i.A,{severity:"warning",children:"No News Found."})})]})]})}}}]);
//# sourceMappingURL=851.576a8b50.chunk.js.map